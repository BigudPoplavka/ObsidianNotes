#Машинное_обучение #CV

В основе работы NetVLAD лежит сверточная нейронная сеть. В классических методах поиска особых точек принцип их выбора заранее предопределен алгоритмом работы и назначенными коэффициентами. Модель нейронной сети NetVLAD обучается находить именно те дескрипторы, которые наиболее точно и однозначно описывают конкретную локацию. Также на вход нейронной сети могут поступать изображения одной и той же локации, но в разные временные моменты. Такая вариативность позволяет модели научиться точно определять местность при разных погодных и внешних условиях, повышая надежность работы всей системы ВРМ. Архитектура нейронной сети NetVLAD состоит из двух частей: сверточных слоев и слоя NetVLAD

**Задача сверточных слоев** – выработка необходимой последовательности карт признаков, где маловажные детали отфильтрованы, а существенные выделены. Сверточными слоями нейронной сети могут выступать слои из архитектур классификационных нейронных сетей, которые позволяют осуществлять гибкую настройку модели NetVLAD.

**==NetVLAD-слой отвечает за объединение извлеченных дескрипторов в фиксированное представление изображения, а именно в вектор локально агрегированных дескрипторов (ВЛАД)==**.

Данная кодировка позволяет собирать статистическую информацию о **локально агрегированных дескрипторах по всему изображению**.

> **==ВЛАД хранит сумму остатков (вектор разницы между дескриптором и его соответствующим центром кластера==**) для каждого **==визуального слова==** -
    **то есть для наборов ключевых точек и дескрипторов, при помощи которых формируется представление изображения в виде частотной гистограммы объектов**.

![[Pasted image 20240821133703.png]]

![[Pasted image 20240821133821.png]]

Для усложнения задачи было принято решение об обучении нейронной сети только на зимнем периоде с целью предсказания локализации для весенних изображений. 

Нехватку данных компенсировали за счет создания дополнительных обучающих данных из уже имеющихся. В ходе обучения нейронной сети применялось выполнение **аугментаций «на лету».** В список аугментаций вошли: случайная яркость, случайная контрастность, размытие, различные виды шума и др. В качестве сверточных слоев для NetVLAD была использована архитектура ResNet-18. В ходе экспериментов с разными вариантами сверточных слоев, было определено, что такая архитектура достаточна для эффективной работы NetVLAD. Небольшое количество параметров ResNet-18 в сравнение с более глубокими собратьями позволила добиться высокого быстродействия. В качестве функции потерь был выбран **Triplet loss**

