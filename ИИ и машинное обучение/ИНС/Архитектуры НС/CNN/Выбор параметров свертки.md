#Машинное_обучение #Нейросети 
[[Свертка]]
[[Сверточные нейросети]]
## Как мы задаём параметры свёртки (kernel size, stride, padding)

Свёртка (Conv2D) — это ключевая операция в свёрточных нейросетях для извлечения пространственных признаков из изображений. Параметры свёртки определяют, каким образом происходит эта операция.
## 1. Размер ядра свёртки (kernel size)
    
Размер ядра определяет область (окно), по которой свёртка "проходит" на каждом шаге.
    
- Типичные размеры: 3x3, 5x5, реже 7x7.
- **Маленькие ядра (3x3)**: позволяют лучше выделять локальные признаки и более гибки.
- **Большие ядра (5x5, 7x7)**: захватывают больше информации сразу, но могут пропускать мелкие детали.
    
Пример: ядро 3x3 скользит по изображению и "видит" только область 3x3 на каждом шаге.
    
В задачах классификации часто используется 3x3, так как оно эффективно обрабатывает локальные структуры изображения.
## 2. Шаг (stride)
    
Шаг определяет, на сколько пикселей перемещается окно свёртки по изображению.
    
- **Stride = 1**: свёртка перемещается на один пиксель, сохраняя много информации, но увеличивая вычислительную нагрузку.
- **Stride = 2**: свёртка перемещается на два пикселя, уменьшая выходной размер, но теряя часть информации.
    
Использование большего шага помогает уменьшить размер изображения быстрее, что может быть полезно для ускорения вычислений.
    
Пример: если stride = 2, то после применения свёртки к изображению 32x32, размер выходного тензора уменьшится до 16x16.
## 3. Пэддинг (padding)
    
Пэддинг — добавление дополнительных нулевых пикселей вокруг границ изображения перед свёрткой.
    
- **Padding = 0 (valid)**: свёртка не добавляет нулевые пиксели, и размер изображения уменьшается.
- **Padding = 1 (same)**: добавление нулевых пикселей для сохранения размера изображения при свёртке.
    
Пример: при kernel size = 3x3 и padding = 1, размер изображения до и после свёртки останется таким же.
    
Пэддинг нужен для того, чтобы:
    
- Сохранить пространственную информацию у границ изображений (без пэддинга информация у краев будет "теряться").
- Сохранить размер изображения, если это важно для последующих слоев.

### Пример использования параметров свёртки
![[Pasted image 20241010003250.png]]

- **in_channels=3**: 3 канала (RGB изображение).
- **out_channels=32**: 32 фильтра, которые будут извлекать 32 разных признака.
- **kernel_size=3**: ядро 3x3 для захвата локальных признаков.
- **stride=1**: каждый шаг свёртки смещает на 1 пиксель.
- **padding=1**: добавляется 1 пиксель нулей по краям, чтобы сохранить размер входного изображения.

| Параметр        | Когда использовать                      | Пример задачи                                                     |
| --------------- | --------------------------------------- | ----------------------------------------------------------------- |
| **Kernel size** | 3x3 — универсальный для всех задач      | Классификация, детекция                                           |
|                 | 5x5, 7x7 — если нужно больше информации | Детекция крупных объектов                                         |
| **Stride**      | 1 — для более точной обработки          | Классификация мелких объектов                                     |
|                 | 2 — для ускорения и уменьшения размера  | Детекция, быстрая свёртка                                         |
| **Padding**     | 1 — сохранить размер                    | Задачи, где важно сохранить пространственные отношения (детекция) |
|                 | 0 — если уменьшение размера допустимо   | Классификация, когда не важны крайние детали                      |
 ![[Pasted image 20241010003420.png]]